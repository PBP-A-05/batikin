<div class="order-info-section bg-[#F9F9F9] py-8 px-6 rounded-lg shadow-lg">
    <h2 class="text-2xl font-semibold text-[#4C3108] mb-4">Informasi Pesanan</h2>

    <div class="product-card border border-[#D8CDB3] rounded-lg p-6 flex items-center justify-between bg-white shadow-md">
        <!-- Product Image -->
        <div class="product-image flex-shrink-0">
            <img src="{{ item_with_total.item.product.image_urls.0 }}" alt="{{ item_with_total.item.product.product_name }}" class="w-24 h-24 object-cover rounded-lg">
        </div>

        <!-- Product Details -->
        <div class="product-details ml-4 flex-grow">
            <h3 class="text-lg font-semibold text-[#4C3108]">{{ item_with_total.item.product.product_name }}</h3>
            <p class="text-sm text-[#714503]">{{ item_with_total.item.product.category }} - {{ item_with_total.item.product.size }}</p>
            <p class="text-sm text-[#714503]">+{{ item_with_total.item.quantity|add:"-1" }} produk lainnya</p>
        </div>

        <!-- Quantity Selector -->
        <div class="quantity-selector mr-4">
            <label for="quantity-{{ item_with_total.item.product.id }}" class="text-sm font-semibold text-[#4C3108]">Kuantitas:</label>
            <div class="flex items-center space-x-2 mt-1">
                <button onclick="adjustQuantity({{ item_with_total.item.product.id }}, -1)" class="px-2 py-1 border rounded-full bg-[#754B0B] text-white">-</button>
                <input id="quantity-{{ item_with_total.item.product.id }}" type="number" min="1" value="{{ item_with_total.item.quantity }}" class="w-12 text-center border rounded-md">
                <button onclick="adjustQuantity({{ item_with_total.item.product.id }}, 1)" class="px-2 py-1 border rounded-full bg-[#754B0B] text-white">+</button>
            </div>
        </div>

        <!-- Total Price -->
        <div class="total-price text-right">
            <p class="text-sm font-semibold text-[#714503]">Total Belanja</p>
            <p class="text-lg font-bold text-[#4C3108]">Rp{{ item_with_total.item_total }}</p>
        </div>
    </div>
</div>

<script>
    function adjustQuantity(productId, adjustment) {
        const quantityInput = document.getElementById(`quantity-${productId}`);
        let newQuantity = parseInt(quantityInput.value) + adjustment;
        if (newQuantity < 1) newQuantity = 1;
        quantityInput.value = newQuantity;

        const updateUrl = `/cart/update/${productId}/`;
        fetch(updateUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify({ 'quantity': newQuantity })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Quantity updated successfully!');
                location.reload(); // Reload to reflect changes
            } else {
                alert('Failed to update quantity.');
            }
        })
        .catch(error => console.error('Error:', error));
    }
</script>
